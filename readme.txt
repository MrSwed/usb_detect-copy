Определение вставленной флэшки, копирование заданных данных на нее и ее извлечение.

Для запуска процесса использовать пакетный файл _usb_copy.bat

Обязательные файлы
start_copy.bat - запуск копирования данных (xcopy) и запуск deveject.exe
deveject.exe   - извлечение флешки (http://withopf.com/tools/deveject)
xcopy.exe      - расширенная утилита консольного копирования 
                 (входит в состав vista и 7 - удалить если есть)
                 (http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/xcopy.mspx)
detect.vbs     - Скрипт определения события вставки и извлечения флешки

sources.txt    - список копируемых данных () - в каждой строке свой
Формат <source>[|destination]  
(Разделенные вертикальной чертой)
  source - полный путь к файлу (каталогу)

Если destination не указан, то будет скопировано в корень, при этом если source - каталог, то необходимо ставить маску

Примеры

d:\temp\data\*.*

d:\temp\data1|\data\data1
d:\temp\data2|\data2



Необязательные
timeout.exe   - необходим для увеличения паузы между попытками отключения флешки 
                (входит в состав серверных ОС и vista, 7 - удалить если есть)


После запуска _usb_copy.bat можно вставлять флешку
О событиях информируют сообщения и звуковые сигналы
При успешном копировании и извлечении - тройной, при ошибке двойной сигнал (#7)

Выход из режима ожидания - CTRL+C

ЗЫ. Удачи.

-- 
Best regards,
 Sergey Davydov                                 mailto:sysadmin@sdcollection.com

